---
# Preamble

## Author
author:
  name: Артём Дмитриевич Петлин
  degrees: Student
  orcid: 0000-0002-0877-7063
  email: 1132246846@pfur.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6
## Title
title: "Отчёт по лабораторной работе №9"
license: "CC BY"
## Generic options
lang: ru-RU
number-sections: true
toc: true
toc-title: "Содержание"
toc-depth: 2
## Crossref customization
crossref:
  lof-title: "Список иллюстраций"
  lot-title: "Список таблиц"
  lol-title: "Листинги"
## Bibliography
bibliography:
  - bib/cite.bib
csl: _resources/csl/gost-r-7-0-5-2008-numeric.csl
## Formats
format:
### Pdf output format
  pdf:
    toc: true
    number-sections: true
    colorlinks: false
    toc-depth: 2
    lof: true # List of figures
    lot: true # List of tables
#### Document
    documentclass: scrreprt
    papersize: a4
    fontsize: 12pt
    linestretch: 1.5
#### Language
    babel-lang: russian
    babel-otherlangs: english
#### Biblatex
    cite-method: biblatex
    biblio-style: gost-numeric
    biblatexoptions:
      - backend=biber
      - langhook=extras
      - autolang=other*
#### Misc options
    csquotes: true
    indent: true
    header-includes: |
      \usepackage{indentfirst}
      \usepackage{float}
      \floatplacement{figure}{H}
      \usepackage[math,RM={Scale=0.94},SS={Scale=0.94},SScon={Scale=0.94},TT={Scale=MatchLowercase,FakeStretch=0.9},DefaultFeatures={Ligatures=Common}]{plex-otf}
### Docx output format
  docx:
    toc: true
    number-sections: true
    toc-depth: 2
---

# Цель работы

Получить навыки работы с контекстом безопасности и политиками SELinux.

# Задание

1. Продемонстрируйте навыки по управлению режимами SELinux (см. раздел 9.4.1).
2. Продемонстрируйте навыки по восстановлению контекста безопасности SELinux (см.
раздел 9.4.2).
3. Настройте контекст безопасности для нестандартного расположения файлов веб-
службы (см. раздел 9.4.3).
4. Продемонстрируйте навыки работы с переключателями SELinux (см. раздел 9.4.4).

# Теоретическое введение

SELinux (Security-Enhanced Linux) — реализация мандатного управления доступом в ядре
Linux.
Мандатное управление доступом (Mandatory Access Control, MAC) — разграничение прав
доступа субъектов к объектам системы на базе меток конфиденциальности.
Под объектами понимаются файлы, каталоги, устройства операционной системы.
В качестве субъектов выступают процессы операционной системы. Метка в SELinux —
контекст SELinux, содержащий информацию о принадлежности объекта системы пользователю SELinux, о его роли, типе и уровне безопасности. Основное назначение архитектуры MAC [5] — возможность принудительного назначения административно-установленной политики безопасности над всеми процессами и файлами системы.
Политики безопасности SELinux работают поверх стандартного дискреционного управления контролем доступа (Discretionary Access Control, DAC) в Unix/Linux операционных
системах.

# Выполнение лабораторной работы

![selinux](image/1.png){#fig-001 width=100%}

Получаем полномочия администратора. Просматриваем подробную информацию о текущем состоянии SELinux, анализируя вывод команды.

![getenforce](image/2.png){#fig-002 width=100%}

Проверяем текущий режим работы SELinux. Убеждаемся, что по умолчанию используется режим принудительного исполнения. Изменяем режим работы SELinux на разрешающий и подтверждаем изменение текущего режима.

![disabled](image/3.png){#fig-003 width=100%}

Редактируем конфигурационный файл, чтобы полностью отключить SELinux, и перезагружаем систему.

![getenforce](image/4.png){#fig-004 width=100%}

После перезагрузки снова проверяем статус SELinux и убеждаемся, что он отключен. Пытаемся переключить режим работы SELinux без перезагрузки и анализируем реакцию системы.

![enforcing](image/5.png){#fig-005 width=100%}

Возвращаем настройку SELinux в режим принудительного исполнения через конфигурационный файл и перезагружаем систему. Во время загрузки наблюдаем сообщения системы, связанные с восстановлением меток безопасности.

![setstatus -v](image/6.png){#fig-006 width=100%}

После завершения загрузки проверяем, что система работает в принудительном режиме с активным SELinux.

![restorecon](image/7.png){#fig-007 width=100%}

Получаем полномочия администратора. Просматриваем контекст безопасности системного файла. Копируем этот файл в домашний каталог и проверяем, как изменился его контекст безопасности. Перемещаем файл обратно в системный каталог, заменяя оригинал. Убеждаемся, что контекст безопасности файла остался неправильным. Восстанавливаем правильный контекст безопасности для файла с подробным выводом процесса. Проверяем, что контекст безопасности был успешно исправлен. Инициируем массовое восстановление контекстов безопасности во всей файловой системе и перезагружаем систему, наблюдая за процессом перемаркировки.

![httpd](image/8.png){#fig-008 width=100%}


![lynx](image/9.png){#fig-009 width=100%}

Получаем полномочия администратора. Устанавливаем необходимое программное обеспечение: httpd и lynx.

![web](image/10.png){#fig-010 width=100%}

Создаем новый каталог для файлов веб-сервера вне стандартного расположения. Создаем в этом каталоге тестовую веб-страницу.

![DocumentRoot](image/11.png){#fig-011 width=100%}

![Directory](image/12.png){#fig-012 width=100%}

Изменяем конфигурацию веб-сервера, указывая новый каталог в качестве корневого и настраивая правила доступа к нему. Запускаем веб-сервер и добавляем его в автозагрузку.

![lynx](image/13.png){#fig-013 width=100%}

![Red Hat](image/14.png){#fig-014 width=100%}

Пытаемся обратиться к веб-серверу через текстовый браузер и обнаруживаем, что отображается стандартная страница, а не наша.

![semanage | restorecon](image/15.png){#fig-015 width=100%}

Добавляем правило в политику SELinux, назначая правильный тип контекста для нового каталога и его содержимого. Восстанавливаем контекст безопасности для нового каталога с рекурсивным применением.

![lynx](image/16.png){#fig-016 width=100%}

Снова обращаемся к веб-серверу и убеждаемся, что теперь отображается наша пользовательская страница. При необходимости перезагружаем систему.

![getsebool](image/17.png){#fig-017 width=100%}

Получаем полномочия администратора. Просматриваем список всех переключателей SELinux, связанных со службой FTP.

![setsebool](image/18.png){#fig-018 width=100%}

Ищем подробное описание переключателей для анонимного доступа FTP, включая их текущее состояние и назначение. Временно изменяем значение одного из переключателей. Проверяем, что значение переключателя изменилось. Снова смотрим подробный список переключателей и обращаем внимание на разницу между временным и постоянным состоянием. Изменяем значение переключателя постоянно. Проверяем окончательное состояние переключателя, убеждаясь, что теперь и временное, и постоянное значения совпадают.

# Выводы

Мы получили навыки работы с контекстом безопасности и политиками SELinux.

# Список литературы{.unnumbered}

::: {.refs}
1. UNIX Power Tools / M. Loukides, T. O’Reilly, J. Peek, S. Powers. — O’Reilly Media, 2009.
2. Робачевский А., Немнюгин С., Стесик О. Операционная система UNIX. — 2-е изд. —
БХВ-Петербург, 2010.
3. Колисниченко Д. Н. Самоучитель системного администратора Linux. — СПб. : БХВ-
Петербург, 2011. — (Системный администратор).
4. Таненбаум Э., Бос Х. Современные операционные системы. — 4-е изд. — СПб. : Питер,
2015. — (Классика Computer Science).
5. Neil N. J. Learning CentOS: A Beginners Guide to Learning Linux. — CreateSpace Inde-
pendent Publishing Platform, 2016.
6. Goyal S. K. Precise Guide to Centos 7: Beginners guide and quick reference. — Indepen-
dently published, 2017.
7. Unix и Linux: руководство системного администратора / Э. Немет, Г. Снайдер, Т.
Хейн, Б. Уэйли, Д. Макни. — 5-е изд. — СПб. : ООО «Диалектика», 2020.
:::
