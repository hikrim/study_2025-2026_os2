---
# Preamble

## Author
author:
  name: Артём Дмитриевич Петлин
  degrees: Student
  orcid: 0000-0002-0877-7063
  email: 1132246846@pfur.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6
## Title
title: "Отчёт по лабораторной работе №11"
license: "CC BY"
## Generic options
lang: ru-RU
number-sections: true
toc: true
toc-title: "Содержание"
toc-depth: 2
## Crossref customization
crossref:
  lof-title: "Список иллюстраций"
  lot-title: "Список таблиц"
  lol-title: "Листинги"
## Bibliography
bibliography:
  - bib/cite.bib
csl: _resources/csl/gost-r-7-0-5-2008-numeric.csl
## Formats
format:
### Pdf output format
  pdf:
    toc: true
    number-sections: true
    colorlinks: false
    toc-depth: 2
    lof: true # List of figures
    lot: true # List of tables
#### Document
    documentclass: scrreprt
    papersize: a4
    fontsize: 12pt
    linestretch: 1.5
#### Language
    babel-lang: russian
    babel-otherlangs: english
#### Biblatex
    cite-method: biblatex
    biblio-style: gost-numeric
    biblatexoptions:
      - backend=biber
      - langhook=extras
      - autolang=other*
#### Misc options
    csquotes: true
    indent: true
    header-includes: |
      \usepackage{indentfirst}
      \usepackage{float}
      \floatplacement{figure}{H}
      \usepackage[math,RM={Scale=0.94},SS={Scale=0.94},SScon={Scale=0.94},TT={Scale=MatchLowercase,FakeStretch=0.9},DefaultFeatures={Ligatures=Common}]{plex-otf}
### Docx output format
  docx:
    toc: true
    number-sections: true
    toc-depth: 2
---

# Цель работы

Получить навыки работы с загрузчиком системы GRUB2.

# Задание

1. Продемонстрируйте навыки по изменению параметров GRUB и записи изменений
в файл конфигурации (см. раздел 11.4.1).
2. Продемонстрируйте навыки устранения неполадок при работе с GRUB (см. раздел 11.4.2).
3. Продемонстрируйте навыки работы с GRUB без использования root (см. раздел 11.4.3).

# Теоретическое введение

Загрузка операционной системы непосредственно после включения и запуска
начальной загрузочной последовательности действий компьютера осуществляется специальным программным обеспечением — загрузчиком операционной системы.
Наиболее распространённый загрузчик для Unix/Linux операционных систем — GRUB
(GRand Unified Bootloader).
Определить версию загрузчика можно с помощью команды

```grub2-install --version```

Основной файл конфигурации GRUB2 — /boot/grub2/grub.cfg. Этот файл генерируется автоматически с помощью файла настроек /etc/default/grub и скриптов из
директории /etc/grub.d.

# Выполнение лабораторной работы

![su -](image/1.png){#fig-001 width=100%}

Получаем полномочия администратора. Редактируем конфигурационный файл загрузчика, устанавливая время отображения меню загрузки равным 10 секундам.

![grub2-mkconfig](image/2.png){#fig-002 width=100%}

Применяем изменения, генерируя новый конфигурационный файл загрузчика.

![grub menu](image/3.jpg){#fig-003 width=100%}

Перезагружаем систему и проверяем, что меню загрузки теперь отображается в течение установленного времени. 

![grub](image/5.jpg){#fig-004 width=100%}

Добавляем параметр загрузки, который запускает систему в режиме восстановления, и убираем параметры, скрывающие процесс загрузки.

![rescue](image/6.jpg){#fig-006 width=100%}

Загружаем систему с измененными параметрами. Вводим пароль пользователя root при появлении запроса.

![rescue](image/7.jpg){#fig-007 width=100%}

Изучаем список загруженных системных юнитов в режиме восстановления.

![rescue](image/8.jpg){#fig-008 width=100%}

Проверяем установленные переменные окружения. Перезагружаем систему.

![emergency](image/9.jpg){#fig-009 width=100%}

Снова входим в режим редактирования параметров загрузки и на этот раз указываем аварийный режим загрузки.

![emergency](image/10.jpg){#fig-010 width=100%}

Загружаем систему в аварийном режиме. Снова вводим пароль пользователя root.

![emergency](image/11.jpg){#fig-011 width=100%}

Сравниваем список загруженных системных юнитов в аварийном режиме с предыдущим режимом восстановления, отмечая значительное сокращение количества загруженных компонентов.

![rd.break](image/12.jpg){#fig-012 width=100%}

Перезагружаем компьютер и входим в режим редактирования параметров загрузки через меню GRUB. Добавляем параметр, который прерывает процесс загрузки на раннем этапе, и убираем параметры графической заставки. 

![rd.break](image/13.jpg){#fig-013 width=100%}

Процесс загрузки останавливается до монтирования корневой файловой системы. Снова вводим пароль пользователя root.

![rd.break](image/14.jpg){#fig-014 width=100%}

Загружаем систему с указанным параметром. Процесс загрузки останавливается до монтирования корневой файловой системы. Перемонтируем системный образ с правами записи. Изменяем корневой каталог на системный образ. Устанавливаем новый пароль для пользователя root. Загружаем политику SELinux, так как на этом этапе она еще не активирована. Вручную восстанавливаем правильный контекст безопасности для файла с паролями. Принудительно перезагружаем систему.

![итог](image/15.jpg){#fig-015 width=100%}

Проверяем возможность входа с новым паролем.

# Ответы на контрольные вопросы

1. Какой файл конфигурации следует изменить для применения общих изменений в GRUB2?
Основной файл для внесения общих изменений в GRUB2 находится по пути /etc/default/grub. В этом файле мы настраиваем такие параметры, как время отображения меню загрузки, параметры ядра по умолчанию и другие основные настройки загрузчика.

2. Как называется конфигурационный файл GRUB2, в котором вы применяете изменения для GRUB2?
Основной генерируемый конфигурационный файл GRUB2 имеет имя /boot/grub2/grub.cfg. Важно отметить, что этот файл автоматически генерируется на основе настроек в /etc/default/grub и скриптов в /etc/grub.d/, поэтому мы не редактируем его напрямую.

3. После внесения изменений в конфигурацию GRUB2, какую команду вы должны выполнить, чтобы изменения сохранились и воспринялись при загрузке системы?
После внесения изменений в файл /etc/default/grub мы выполняем команду grub2-mkconfig -o /boot/grub2/grub.cfg, которая генерирует новый конфигурационный файл на основе измененных настроек. Только после выполнения этой команды изменения вступят в силу при следующей загрузке системы.

# Выводы

Мы получили навыки работы с загрузчиком системы GRUB2.

# Список литературы{.unnumbered}

::: {.refs}
1. Колисниченко Д. Н. Самоучитель системного администратора Linux. — СПб. : БХВ-
Петербург, 2011. — (Системный администратор).
2. Neil N. J. Learning CentOS: A Beginners Guide to Learning Linux. — CreateSpace Inde-
pendent Publishing Platform, 2016.
3. Unix и Linux: руководство системного администратора / Э. Немет, Г. Снайдер, Т.
Хейн, Б. Уэйли, Д. Макни. — 5-е изд. — СПб. : ООО «Диалектика», 2020.
:::
